{% macro calendar_event_invitation(parentEvent) %}
    <div class="row-fluid">
        <div class="responsive-block">
            <ul class="user-status-list list-group">
                {% for attendee in parentEvent.childAttendees %}
                    {{ _self.build_invitation_link(attendee) }}
                {% endfor %}
            </ul>
        </div>
    </div>
{% endmacro %}

{% macro build_invitation_link(attendee) %}
    {% import 'OroUIBundle::macros.html.twig' as UI %}
        {% set invitationStatus = attendee.status ? attendee.status.id : null %}
        {% set invitationClass = _self.get_invitatition_status_class(invitationStatus) %}
        <li class="list-group-item">
            <i {% if invitationClass %}class="{{ invitationClass }}" title="{{ attendee.status.name }}"{% endif %}></i>
            <span class="list-group-item-text">
                {% if attendee.user %}
                    {% set avatar = attendee.user.avatar %}
                    <img src="{{ avatar ? filtered_image_url(avatar, 'avatar_xsmall') : asset('bundles/oroui/img/avatar-xsmall.png') }}" />
                {% endif %}
                {% if (resource_granted('oro_user_user_view') and attendee.user) %}
                    {{ UI.link({
                        'label' : attendee.displayName,
                        'path'  : path('oro_user_view', {'id': attendee.user.id })
                    }) }}
                {% else %}
                    {{ attendee.email }}
                {% endif %}
            </span>
        </li>
{% endmacro %}

{% macro get_invitatition_badge_class(invitationStatus) %}
    {%- if invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_TENTATIVELY_ACCEPTED') -%}
        tentatively
    {%- elseif invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_ACCEPTED') -%}
        enabled
    {%- elseif invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_DECLINED') -%}
        disabled
    {%- endif -%}
{% endmacro %}

{% macro get_invitatition_status_class(invitationStatus) %}
    {%- if invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_NOT_RESPONDED') -%}
        icon-reply
    {%- elseif invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_TENTATIVELY_ACCEPTED') -%}
        icon-question
    {%- elseif invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_ACCEPTED') -%}
        icon-ok
    {%- elseif invitationStatus == constant('Oro\\Bundle\\CalendarBundle\\Entity\\CalendarEvent::STATUS_DECLINED') -%}
        icon-remove
    {%- endif -%}
{% endmacro %}

{# deprecated - use attendee.status.name instead #}
{%- macro calendar_event_invitation_status(statusCode) -%}
    {{ ('oro.calendar.calendarevent.statuses.' ~ statusCode)|trans }}
{%- endmacro -%}

{%- macro calendar_event_invitation_action(statusCode) -%}
    {{ ('oro.calendar.calendarevent.actions.' ~ statusCode)|trans }}
{%- endmacro -%}

{% macro notifyGuestsComponent() %}
    <div style="display: none"
         data-page-component-module="oroui/js/app/components/view-component"
         data-page-component-options="{{ {'view': 'orocalendar/js/app/views/guest-notifier-view'}|json_encode }}">
    </div>
{% endmacro %}

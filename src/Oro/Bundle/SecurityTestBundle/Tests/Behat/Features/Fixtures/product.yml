# TODO: upsells, crossels, variants, matrix 1, matrix 2
# TODO: attribute family with group that contains XSS payload in label

# Test simple product changed attribute family with group containing XSS
# Test configurable product 1 attribute
# Test configurable product 2 attributes
# Test configurable product 3 attributes
# Each of those products has all products as up sells and cross sells
# All this products must be checked at all places where them may be rendered (SL, Checkout, RFQ, Order, Catalog, Search)

Oro\Bundle\LocaleBundle\Entity\LocalizedFallbackValue:
    simple_product_name:
        string: '<xss("LocalizedFallbackValue.string(Product.name)")>'
    simple_product_description:
        text: '<xss("LocalizedFallbackValue.text(Product.description)")>'
    simple_product_short_description:
        text: '<xss("LocalizedFallbackValue.text(Product.shortDescription)")>'
    configurable_product_variant_1_name:
        string: '<xss("LocalizedFallbackValue.string(Product.name)")>'
    configurable_product_variant_1_description:
        text: '<xss("LocalizedFallbackValue.text(Product.description)")>'
    configurable_product_variant_1_short_description:
        text: '<xss("LocalizedFallbackValue.text(Product.shortDescription)")>'
    configurable_product_name:
        string: '<xss("LocalizedFallbackValue.string(Product.name)")>'
    configurable_product_description:
        text: '<xss("LocalizedFallbackValue.text(Product.description)")>'
    configurable_product_short_description:
        text: '<xss("LocalizedFallbackValue.text(Product.shortDescription)")>'
    tshirt_family_label:
        string: '<xss("LocalizedFallbackValue.string(AttributeFamily.label)")>'
    attribute_group_label:
        string: '<xss("LocalizedFallbackValue.string(AttributeGroup.label)")>'
    product_meta_title_{1..3}:
        string: '<xss("LocalizedFallbackValue.string(Product.metaTitle)")>'
    product_meta_description_{1..3}:
        text: '<xss("LocalizedFallbackValue.string(Product.metaDescription)")>'
    product_meta_keywords_{1..3}:
        text: '<xss("LocalizedFallbackValue.string(Product.metaKeyword)")>'
    product_slug_prototype_{1..3}:
        string: '<xss("LocalizedFallbackValue.string(Product.slugPrototype)")>'
    brand_name:
        string: '<xss("LocalizedFallbackValue.string(Brand.name)")>'
    brand_description:
        text: '<xss("LocalizedFallbackValue.string(Brand.brandDescription)")>'
    brand_short_description:
        text: '<xss("LocalizedFallbackValue.string(Brand.brandShortDescription)")>'
    brand_meta_title:
        string: '<xss("LocalizedFallbackValue.string(Brand.metaTitle)")>'
    brand_meta_description:
        text: '<xss("LocalizedFallbackValue.string(Brand.metaDescription)")>'
    brand_meta_keywords:
        text: '<xss("LocalizedFallbackValue.string(Brand.metaKeyword)")>'
    brand_slug_prototype:
        string: '<xss("LocalizedFallbackValue.string(Brand.slugPrototype)")>'

Oro\Bundle\ProductBundle\Entity\ProductUnitPrecision:
    precision{1..3}:
        unit: '@item'
        precision: '1'

Oro\Bundle\EntityConfigBundle\Attribute\Entity\AttributeFamily:
    tshirt_family:
        owner: '@xss_user'
        organization: '@xss_organization'
        entityClass: 'Oro\Bundle\ProductBundle\Entity\Product'
        code: 'T_shirt'
        addLabel: ['@tshirt_family_label']

Oro\Bundle\EntityConfigBundle\Attribute\Entity\AttributeGroup:
    attribute_group:
        addLabel: ['@attribute_group_label']
        code: 'attribute_group'
        attributeFamily: '@tshirt_family'

Oro\Bundle\EntityConfigBundle\Attribute\Entity\AttributeGroupRelation:
    attribute_group_relation_sku:
        attributeGroup: '@attribute_group'
        entityConfigFieldId: '@field_config_product_sku->id'
    attribute_group_relation_name:
        attributeGroup: '@attribute_group'
        entityConfigFieldId: '@field_config_product_names->id'
    attribute_group_relation_description:
        attributeGroup: '@attribute_group'
        entityConfigFieldId: '@field_config_product_descriptions->id'
    attribute_group_relation_short_description:
        attributeGroup: '@attribute_group'
        entityConfigFieldId: '@field_config_product_shortDescriptions->id'
    attribute_group_relation_short_brand:
        attributeGroup: '@attribute_group'
        entityConfigFieldId: '@field_config_product_brand->id'

Oro\Bundle\RedirectBundle\Entity\Slug:
    product_slug_{1..4}:
        url: '<xss("Slug.url")>'
        slugPrototype: '<xss("Slug.slugPrototype")>'
        routeName: '<xss("Slug.routeName")>'

Oro\Bundle\ProductBundle\Entity\Brand:
    brand:
        owner: '@xss_business_unit'
        organization: '@xss_organization'
        addName: ['@brand_name']
        addDescription: ['@brand_short_description']
        addShortDescription: ['@brand_short_description']
        metaTitles: ['@brand_meta_title']
        metaDescriptions: ['@brand_meta_description']
        metaKeywords: ['@brand_meta_keywords']
        slugPrototypes: ['@brand_slug_prototype']
        slugs: ['@product_slug_4']

Oro\Bundle\ProductBundle\Entity\Product:
    simple_product:
        type: 'simple'
        organization: '@xss_organization'
        owner: '@xss_business_unit'
        sku: 'S01<xss("Product.sku")>'
        skuUppercase: 'S01<xss("Product.skuUppercase")>'
        brand: '@brand'
        denormalizedDefaultName: '<xss("Product.denormalizedDefaultName")>'
        denormalizedDefaultNameUppercase: '<xss("Product.denormalizedDefaultNameUppercase")>'
        primaryUnitPrecision: '@precision1'
        attributeFamily: '@defaultProductFamily'
        addName: ['@simple_product_name']
        addDescription: ['@simple_product_description']
        addShortDescription: ['@simple_product_short_description']
        inventoryStatus: '@enumInventoryStatuses'
        status: 'enabled'
        metaTitles: ['@product_meta_title_1']
        metaDescriptions: ['@product_meta_description_1']
        metaKeywords: ['@product_meta_keywords_1']
        slugPrototypes: ['@product_slug_prototype_1']
        slugs: ['@product_slug_1']
        taxCode: '@product_tax_code'
    configurable_product_variant_1:
        type: 'simple'
        organization: '@xss_organization'
        owner: '@xss_business_unit'
        sku: 'S02<xss("Product.sku")>'
        skuUppercase: 'S02<xss("Product.skuUppercase")>'
        brand: '@brand'
        denormalizedDefaultName: '<xss("Product.denormalizedDefaultName")>'
        denormalizedDefaultNameUppercase: '<xss("Product.denormalizedDefaultNameUppercase")>'
        primaryUnitPrecision: '@precision2'
        attributeFamily: '@tshirt_family'
        addName: ['@configurable_product_variant_1_name']
        addDescription: ['@configurable_product_variant_1_description']
        addShortDescription: ['@configurable_product_variant_1_short_description']
        inventoryStatus: '@enumInventoryStatuses'
        status: 'enabled'
        metaTitles: ['@product_meta_title_2']
        metaDescriptions: ['@product_meta_description_2']
        metaKeywords: ['@product_meta_keywords_2']
        slugPrototypes: ['@product_slug_prototype_2']
        slugs: ['@product_slug_2']
        taxCode: '@product_tax_code'
    configurable_product:
        type: 'configurable'
        organization: '@xss_organization'
        owner: '@xss_business_unit'
        sku: 'S03<xss("Product.sku")>'
        skuUppercase: 'S03<xss("Product.skuUppercase")>'
        brand: '@brand'
        denormalizedDefaultName: '<xss("Product.denormalizedDefaultName")>'
        denormalizedDefaultNameUppercase: '<xss("Product.denormalizedDefaultNameUppercase")>'
        attributeFamily: '@tshirt_family'
        primaryUnitPrecision: '@precision3'
        addName: ['@configurable_product_name']
        addDescription: ['@configurable_product_description']
        addShortDescription: ['@configurable_product_short_description']
        inventoryStatus: '@enumInventoryStatuses'
        status: 'enabled'
        metaTitles: ['@product_meta_title_3']
        metaDescriptions: ['@product_meta_description_3']
        metaKeywords: ['@product_meta_keywords_3']
        slugPrototypes: ['@product_slug_prototype_3']
        slugs: ['@product_slug_3']
        taxCode: '@product_tax_code'
